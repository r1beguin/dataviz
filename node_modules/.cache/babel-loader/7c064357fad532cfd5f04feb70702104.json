{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { forwardRef, useCallback, useContext, useMemo, useRef, useState, useEffect } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { Heading } from '../Heading';\nimport { Keyboard } from '../Keyboard';\nimport { StyledCalendar, StyledDay, StyledDayContainer, StyledWeek, StyledWeeks, StyledWeeksContainer } from './StyledCalendar';\nimport { addDays, addMonths, betweenDates, daysApart, endOfMonth, startOfMonth, subtractDays, subtractMonths, withinDates } from './utils';\nvar headingPadMap = {\n  small: 'xsmall',\n  medium: 'small',\n  large: 'medium'\n};\n\nvar normalizeReference = function normalizeReference(reference, date, dates) {\n  var normalizedReference;\n\n  if (reference) {\n    normalizedReference = new Date(reference);\n  } else if (date) {\n    normalizedReference = new Date(date);\n  } else if (dates && dates.length > 0) {\n    if (typeof dates[0] === 'string') {\n      normalizedReference = new Date(dates[0]);\n    } else if (Array.isArray(dates[0])) {\n      normalizedReference = new Date(dates[0][0]);\n    } else {\n      normalizedReference = new Date();\n      normalizedReference.setHours(0, 0, 0, 0);\n    }\n  } else {\n    normalizedReference = new Date();\n    normalizedReference.setHours(0, 0, 0, 0);\n  }\n\n  return normalizedReference;\n};\n\nvar buildDisplayBounds = function buildDisplayBounds(reference, firstDayOfWeek) {\n  var start = new Date(reference);\n  start.setDate(1); // first of month\n  // In case Sunday is the first day of the month, and the user asked for Monday\n  // to be the first day of the week, then we need to include Sunday and six\n  // days prior.\n\n  start = start.getDay() === 0 && firstDayOfWeek === 1 ? start = subtractDays(start, 6) : // beginning of week\n  start = subtractDays(start, start.getDay() - firstDayOfWeek);\n  var end = addDays(start, 7 * 5 + 7); // 5 weeks to end of week\n\n  return [start, end];\n};\n\nvar millisecondsPerYear = 31557600000;\nvar Calendar = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var _ref$animate = _ref.animate,\n      animate = _ref$animate === void 0 ? true : _ref$animate,\n      validBounds = _ref.bounds,\n      dateProp = _ref.date,\n      datesProp = _ref.dates,\n      daysOfWeek = _ref.daysOfWeek,\n      disabled = _ref.disabled,\n      _ref$firstDayOfWeek = _ref.firstDayOfWeek,\n      firstDayOfWeek = _ref$firstDayOfWeek === void 0 ? 0 : _ref$firstDayOfWeek,\n      header = _ref.header,\n      _ref$locale = _ref.locale,\n      locale = _ref$locale === void 0 ? 'en-US' : _ref$locale,\n      onReference = _ref.onReference,\n      onSelect = _ref.onSelect,\n      range = _ref.range,\n      referenceProp = _ref.reference,\n      _ref$showAdjacentDays = _ref.showAdjacentDays,\n      showAdjacentDays = _ref$showAdjacentDays === void 0 ? true : _ref$showAdjacentDays,\n      _ref$size = _ref.size,\n      size = _ref$size === void 0 ? 'medium' : _ref$size,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"animate\", \"bounds\", \"date\", \"dates\", \"daysOfWeek\", \"disabled\", \"firstDayOfWeek\", \"header\", \"locale\", \"onReference\", \"onSelect\", \"range\", \"reference\", \"showAdjacentDays\", \"size\"]);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme; // set date when caller changes it, allows us to change it internally too\n\n  var _useState = useState(dateProp),\n      date = _useState[0],\n      setDate = _useState[1];\n\n  useEffect(function () {\n    return setDate(dateProp);\n  }, [dateProp]); // set dates when caller changes it, allows us to change it internally too\n\n  var _useState2 = useState(datesProp),\n      dates = _useState2[0],\n      setDates = _useState2[1];\n\n  useEffect(function () {\n    return setDates(datesProp);\n  }, [datesProp]); // set reference based on what the caller passed or date/dates.\n\n  var _useState3 = useState(normalizeReference(referenceProp, date, dates)),\n      reference = _useState3[0],\n      setReference = _useState3[1];\n\n  useEffect(function () {\n    return setReference(normalizeReference(referenceProp, dateProp, datesProp));\n  }, [dateProp, datesProp, referenceProp]); // calculate the bounds we display based on the reference\n\n  var _useState4 = useState(buildDisplayBounds(reference, firstDayOfWeek)),\n      displayBounds = _useState4[0],\n      setDisplayBounds = _useState4[1];\n\n  var _useState5 = useState(),\n      targetDisplayBounds = _useState5[0],\n      setTargetDisplayBounds = _useState5[1];\n\n  var _useState6 = useState(),\n      slide = _useState6[0],\n      setSlide = _useState6[1]; // When the reference changes, we need to update the displayBounds.\n  // This is easy when we aren't animating. If we are animating,\n  // we temporarily increase the displayBounds to be the union of the old\n  // and new ones and set slide to drive the animation. We keep track\n  // of where we are heading via targetDisplayBounds. When the animation\n  // finishes, we prune displayBounds down to where we are headed and\n  // clear the slide and targetDisplayBounds.\n\n\n  useEffect(function () {\n    var nextDisplayBounds = buildDisplayBounds(reference, firstDayOfWeek);\n\n    if (!animate) {\n      setDisplayBounds(nextDisplayBounds);\n    } else {\n      setTargetDisplayBounds(nextDisplayBounds);\n    }\n  }, [animate, firstDayOfWeek, reference]);\n  useEffect(function () {\n    if (targetDisplayBounds) {\n      var animating;\n\n      if (targetDisplayBounds[0].getTime() < displayBounds[0].getTime()) {\n        // only animate if the duration is within a year\n        if (displayBounds[0].getTime() - targetDisplayBounds[0].getTime() < millisecondsPerYear) {\n          setDisplayBounds([targetDisplayBounds[0], displayBounds[1]]);\n          setSlide({\n            direction: 'down',\n            weeks: daysApart(displayBounds[0], targetDisplayBounds[0]) / 7\n          });\n          animating = true;\n        }\n      } else if (targetDisplayBounds[1].getTime() > displayBounds[1].getTime()) {\n        if (targetDisplayBounds[1].getTime() - displayBounds[1].getTime() < millisecondsPerYear) {\n          setDisplayBounds([displayBounds[0], targetDisplayBounds[1]]);\n          setSlide({\n            direction: 'up',\n            weeks: daysApart(targetDisplayBounds[1], displayBounds[1]) / 7\n          });\n          animating = true;\n        }\n      }\n\n      if (animating) {\n        // Wait for animation to finish before cleaning up.\n        var timer = setTimeout(function () {\n          setDisplayBounds(targetDisplayBounds);\n          setTargetDisplayBounds(undefined);\n          setSlide(undefined);\n        }, 400 // Empirically determined.\n        );\n        return function () {\n          return clearTimeout(timer);\n        };\n      }\n\n      return undefined;\n    }\n\n    setSlide(undefined);\n    return undefined;\n  }, [displayBounds, targetDisplayBounds]); // We have to deal with reference being the end of a month with more\n  // days than the month we are changing to. So, we always set reference\n  // to the first of the month before changing the month.\n\n  var previousMonth = useMemo(function () {\n    return endOfMonth(subtractMonths(startOfMonth(reference), 1));\n  }, [reference]);\n  var nextMonth = useMemo(function () {\n    return startOfMonth(addMonths(startOfMonth(reference), 1));\n  }, [reference]);\n  var daysRef = useRef();\n\n  var _useState7 = useState(),\n      focus = _useState7[0],\n      setFocus = _useState7[1];\n\n  var _useState8 = useState(),\n      active = _useState8[0],\n      setActive = _useState8[1]; // when working on a range, remember the last selected date so we know\n  // how to handle subsequent date selection\n\n\n  var _useState9 = useState(),\n      lastSelectedDate = _useState9[0],\n      setLastSelectedDate = _useState9[1];\n\n  var changeReference = useCallback(function (nextReference) {\n    if (betweenDates(nextReference, validBounds)) {\n      setReference(nextReference);\n      if (onReference) onReference(nextReference.toISOString());\n    }\n  }, [onReference, validBounds]);\n  var selectDate = useCallback(function (selectedDate) {\n    var nextDates;\n    var nextDate;\n\n    if (!range) {\n      nextDate = selectedDate;\n    } else if (!dates) {\n      if (!date) {\n        nextDate = selectedDate;\n      } else {\n        var priorDate = new Date(date);\n        var selDate = new Date(selectedDate);\n\n        if (priorDate.getTime() < selDate.getTime()) {\n          nextDates = [[date, selectedDate]];\n          nextDate = undefined;\n        } else if (priorDate.getTime() > selDate.getTime()) {\n          nextDates = [[selectedDate, date]];\n          nextDate = undefined;\n        } else {\n          nextDate = undefined;\n        }\n      }\n    } else {\n      // have dates\n      var priorDates = dates[0].map(function (d) {\n        return new Date(d);\n      });\n      var previousDate = new Date(lastSelectedDate || dates[0][0]);\n\n      var _selDate = new Date(selectedDate);\n\n      if (_selDate.getTime() === priorDates[0].getTime()) {\n        var _dates$ = dates[0];\n        nextDate = _dates$[1];\n        nextDates = undefined;\n      } else if (_selDate.getTime() === priorDates[1].getTime()) {\n        var _dates$2 = dates[0];\n        nextDate = _dates$2[0];\n        nextDates = undefined;\n      } else if (_selDate.getTime() === previousDate.getTime()) {\n        if (_selDate.getTime() < priorDates[0].getTime()) {\n          nextDates = [[selectedDate, dates[0][1]]];\n        } else if (_selDate.getTime() > priorDates[0].getTime()) {\n          nextDates = [[dates[0][0], selectedDate]];\n        }\n      } else if (_selDate.getTime() < previousDate.getTime()) {\n        if (_selDate.getTime() < priorDates[0].getTime()) {\n          nextDates = [[selectedDate, dates[0][1]]];\n        } else if (_selDate.getTime() > priorDates[0].getTime()) {\n          nextDates = [[dates[0][0], selectedDate]];\n        }\n      } else if (_selDate.getTime() > previousDate.getTime()) {\n        if (_selDate.getTime() > priorDates[1].getTime()) {\n          nextDates = [[dates[0][0], selectedDate]];\n        } else if (_selDate.getTime() < priorDates[1].getTime()) {\n          nextDates = [[selectedDate, dates[0][1]]];\n        }\n      }\n    }\n\n    setDates(nextDates);\n    if (!dates) setDate(nextDate);\n    setActive(new Date(selectedDate));\n    setLastSelectedDate(selectedDate);\n    if (onSelect) onSelect(nextDates || nextDate);\n  }, [date, dates, lastSelectedDate, onSelect, range]);\n\n  var renderCalendarHeader = function renderCalendarHeader() {\n    var PreviousIcon = size === 'small' ? theme.calendar.icons.small.previous : theme.calendar.icons.previous;\n    var NextIcon = size === 'small' ? theme.calendar.icons.small.next : theme.calendar.icons.next;\n    return /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      justify: \"between\",\n      align: \"center\"\n    }, /*#__PURE__*/React.createElement(Box, {\n      flex: true,\n      pad: {\n        horizontal: headingPadMap[size] || 'small'\n      }\n    }, /*#__PURE__*/React.createElement(Heading, {\n      level: size === 'small' ? theme.calendar.heading && theme.calendar.heading.level || 4 : (theme.calendar.heading && theme.calendar.heading.level || 4) - 1,\n      size: size,\n      margin: \"none\"\n    }, reference.toLocaleDateString(locale, {\n      month: 'long',\n      year: 'numeric'\n    }))), /*#__PURE__*/React.createElement(Box, {\n      flex: false,\n      direction: \"row\",\n      align: \"center\"\n    }, /*#__PURE__*/React.createElement(Button, {\n      a11yTitle: previousMonth.toLocaleDateString(locale, {\n        month: 'long',\n        year: 'numeric'\n      }),\n      icon: /*#__PURE__*/React.createElement(PreviousIcon, {\n        size: size !== 'small' ? size : undefined\n      }),\n      disabled: !betweenDates(previousMonth, validBounds),\n      onClick: function onClick() {\n        return changeReference(previousMonth);\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      a11yTitle: nextMonth.toLocaleDateString(locale, {\n        month: 'long',\n        year: 'numeric'\n      }),\n      icon: /*#__PURE__*/React.createElement(NextIcon, {\n        size: size !== 'small' ? size : undefined\n      }),\n      disabled: !betweenDates(nextMonth, validBounds),\n      onClick: function onClick() {\n        return changeReference(nextMonth);\n      }\n    })));\n  };\n\n  var renderDaysOfWeek = function renderDaysOfWeek() {\n    var day = new Date(displayBounds[0]);\n    var days = [];\n\n    while (days.length < 7) {\n      days.push( /*#__PURE__*/React.createElement(StyledDayContainer, {\n        key: days.length,\n        sizeProp: size\n      }, /*#__PURE__*/React.createElement(StyledDay, {\n        otherMonth: true,\n        sizeProp: size\n      }, day.toLocaleDateString(locale, {\n        weekday: 'narrow'\n      }))));\n      day = addDays(day, 1);\n    }\n\n    return /*#__PURE__*/React.createElement(StyledWeek, null, days);\n  };\n\n  var weeks = [];\n  var day = new Date(displayBounds[0]);\n  var days;\n  var firstDayInMonth;\n\n  while (day.getTime() < displayBounds[1].getTime()) {\n    if (day.getDay() === firstDayOfWeek) {\n      if (days) {\n        weeks.push( /*#__PURE__*/React.createElement(StyledWeek, {\n          key: day.getTime()\n        }, days));\n      }\n\n      days = [];\n    }\n\n    var otherMonth = day.getMonth() !== reference.getMonth();\n\n    if (!showAdjacentDays && otherMonth) {\n      days.push( /*#__PURE__*/React.createElement(StyledDayContainer, {\n        key: day.getTime(),\n        sizeProp: size\n      }, /*#__PURE__*/React.createElement(StyledDay, {\n        sizeProp: size\n      })));\n    } else {\n      (function () {\n        var dateString = day.toISOString(); // this.dayRefs[dateString] = React.createRef();\n\n        var selected = false;\n        var inRange = false;\n        var selectedState = withinDates(day, date || dates);\n\n        if (selectedState === 2) {\n          selected = true;\n        } else if (selectedState === 1) {\n          inRange = true;\n        }\n\n        var dayDisabled = withinDates(day, disabled) || validBounds && !betweenDates(day, validBounds);\n\n        if (!firstDayInMonth && !dayDisabled && day.getMonth() === reference.getMonth()) {\n          firstDayInMonth = dateString;\n        }\n\n        days.push( /*#__PURE__*/React.createElement(StyledDayContainer, {\n          key: day.getTime(),\n          sizeProp: size\n        }, /*#__PURE__*/React.createElement(Button, {\n          a11yTitle: day.toDateString(),\n          plain: true,\n          tabIndex: -1,\n          active: active && active.getTime() === day.getTime(),\n          disabled: dayDisabled && !!dayDisabled,\n          onClick: function onClick() {\n            selectDate(dateString); // Chrome moves the focus indicator to this button. Set\n            // the focus to the grid of days instead.\n\n            daysRef.current.focus();\n          },\n          onMouseOver: function onMouseOver() {\n            return setActive(new Date(dateString));\n          },\n          onMouseOut: function onMouseOut() {\n            return setActive(undefined);\n          },\n          onFocus: function onFocus() {},\n          onBlur: function onBlur() {}\n        }, /*#__PURE__*/React.createElement(StyledDay, {\n          inRange: inRange,\n          otherMonth: day.getMonth() !== reference.getMonth(),\n          isSelected: selected,\n          sizeProp: size\n        }, day.getDate()))));\n      })();\n    }\n\n    day = addDays(day, 1);\n  }\n\n  weeks.push( /*#__PURE__*/React.createElement(StyledWeek, {\n    key: day.getTime()\n  }, days));\n  return /*#__PURE__*/React.createElement(StyledCalendar, _extends({\n    ref: ref,\n    sizeProp: size\n  }, rest), /*#__PURE__*/React.createElement(Box, null, header ? header({\n    date: reference,\n    locale: locale,\n    onPreviousMonth: function onPreviousMonth() {\n      return changeReference(previousMonth);\n    },\n    onNextMonth: function onNextMonth() {\n      return changeReference(nextMonth);\n    },\n    previousInBound: betweenDates(previousMonth, validBounds),\n    nextInBound: betweenDates(nextMonth, validBounds)\n  }) : renderCalendarHeader(previousMonth, nextMonth), daysOfWeek && renderDaysOfWeek(), /*#__PURE__*/React.createElement(Keyboard, {\n    onEnter: function onEnter() {\n      return selectDate(active.toISOString());\n    },\n    onUp: function onUp(event) {\n      event.preventDefault();\n      event.stopPropagation(); // so the page doesn't scroll\n\n      setActive(addDays(active, -7));\n    },\n    onDown: function onDown(event) {\n      event.preventDefault();\n      event.stopPropagation(); // so the page doesn't scroll\n\n      setActive(addDays(active, 7));\n    },\n    onLeft: function onLeft() {\n      return active && setActive(addDays(active, -1));\n    },\n    onRight: function onRight() {\n      return active && setActive(addDays(active, 1));\n    }\n  }, /*#__PURE__*/React.createElement(StyledWeeksContainer, {\n    ref: daysRef,\n    sizeProp: size,\n    tabIndex: 0,\n    focus: focus,\n    onFocus: function onFocus() {\n      setFocus(true);\n\n      if (date && betweenDates(new Date(date), displayBounds)) {\n        setActive(new Date(date));\n      } else {\n        setActive(new Date(firstDayInMonth));\n      }\n    },\n    onBlur: function onBlur() {\n      setFocus(false);\n      setActive(undefined);\n    }\n  }, /*#__PURE__*/React.createElement(StyledWeeks, {\n    slide: slide,\n    sizeProp: size\n  }, weeks)))));\n});\nCalendar.displayName = 'Calendar';\nvar CalendarDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  // eslint-disable-next-line global-require\n  CalendarDoc = require('./doc').doc(Calendar);\n}\n\nvar CalendarWrapper = CalendarDoc || Calendar;\nexport { CalendarWrapper as Calendar };","map":{"version":3,"sources":["/Users/erwanbeguin/Documents/Developper/ynov/dataviz/node_modules/grommet/es6/components/Calendar/Calendar.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","forwardRef","useCallback","useContext","useMemo","useRef","useState","useEffect","ThemeContext","defaultProps","Box","Button","Heading","Keyboard","StyledCalendar","StyledDay","StyledDayContainer","StyledWeek","StyledWeeks","StyledWeeksContainer","addDays","addMonths","betweenDates","daysApart","endOfMonth","startOfMonth","subtractDays","subtractMonths","withinDates","headingPadMap","small","medium","large","normalizeReference","reference","date","dates","normalizedReference","Date","Array","isArray","setHours","buildDisplayBounds","firstDayOfWeek","start","setDate","getDay","end","millisecondsPerYear","Calendar","_ref","ref","_ref$animate","animate","validBounds","bounds","dateProp","datesProp","daysOfWeek","disabled","_ref$firstDayOfWeek","header","_ref$locale","locale","onReference","onSelect","range","referenceProp","_ref$showAdjacentDays","showAdjacentDays","_ref$size","size","rest","theme","_useState","_useState2","setDates","_useState3","setReference","_useState4","displayBounds","setDisplayBounds","_useState5","targetDisplayBounds","setTargetDisplayBounds","_useState6","slide","setSlide","nextDisplayBounds","animating","getTime","direction","weeks","timer","setTimeout","undefined","clearTimeout","previousMonth","nextMonth","daysRef","_useState7","focus","setFocus","_useState8","active","setActive","_useState9","lastSelectedDate","setLastSelectedDate","changeReference","nextReference","toISOString","selectDate","selectedDate","nextDates","nextDate","priorDate","selDate","priorDates","map","d","previousDate","_selDate","_dates$","_dates$2","renderCalendarHeader","PreviousIcon","calendar","icons","previous","NextIcon","next","createElement","justify","align","flex","pad","horizontal","level","heading","margin","toLocaleDateString","month","year","a11yTitle","icon","onClick","renderDaysOfWeek","day","days","push","sizeProp","otherMonth","weekday","firstDayInMonth","getMonth","dateString","selected","inRange","selectedState","dayDisabled","toDateString","plain","tabIndex","current","onMouseOver","onMouseOut","onFocus","onBlur","isSelected","getDate","onPreviousMonth","onNextMonth","previousInBound","nextInBound","onEnter","onUp","event","preventDefault","stopPropagation","onDown","onLeft","onRight","displayName","CalendarDoc","process","env","NODE_ENV","require","doc","CalendarWrapper"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef, useCallback, useContext, useMemo, useRef, useState, useEffect } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { Heading } from '../Heading';\nimport { Keyboard } from '../Keyboard';\nimport { StyledCalendar, StyledDay, StyledDayContainer, StyledWeek, StyledWeeks, StyledWeeksContainer } from './StyledCalendar';\nimport { addDays, addMonths, betweenDates, daysApart, endOfMonth, startOfMonth, subtractDays, subtractMonths, withinDates } from './utils';\nvar headingPadMap = {\n  small: 'xsmall',\n  medium: 'small',\n  large: 'medium'\n};\n\nvar normalizeReference = function normalizeReference(reference, date, dates) {\n  var normalizedReference;\n\n  if (reference) {\n    normalizedReference = new Date(reference);\n  } else if (date) {\n    normalizedReference = new Date(date);\n  } else if (dates && dates.length > 0) {\n    if (typeof dates[0] === 'string') {\n      normalizedReference = new Date(dates[0]);\n    } else if (Array.isArray(dates[0])) {\n      normalizedReference = new Date(dates[0][0]);\n    } else {\n      normalizedReference = new Date();\n      normalizedReference.setHours(0, 0, 0, 0);\n    }\n  } else {\n    normalizedReference = new Date();\n    normalizedReference.setHours(0, 0, 0, 0);\n  }\n\n  return normalizedReference;\n};\n\nvar buildDisplayBounds = function buildDisplayBounds(reference, firstDayOfWeek) {\n  var start = new Date(reference);\n  start.setDate(1); // first of month\n  // In case Sunday is the first day of the month, and the user asked for Monday\n  // to be the first day of the week, then we need to include Sunday and six\n  // days prior.\n\n  start = start.getDay() === 0 && firstDayOfWeek === 1 ? start = subtractDays(start, 6) : // beginning of week\n  start = subtractDays(start, start.getDay() - firstDayOfWeek);\n  var end = addDays(start, 7 * 5 + 7); // 5 weeks to end of week\n\n  return [start, end];\n};\n\nvar millisecondsPerYear = 31557600000;\nvar Calendar = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var _ref$animate = _ref.animate,\n      animate = _ref$animate === void 0 ? true : _ref$animate,\n      validBounds = _ref.bounds,\n      dateProp = _ref.date,\n      datesProp = _ref.dates,\n      daysOfWeek = _ref.daysOfWeek,\n      disabled = _ref.disabled,\n      _ref$firstDayOfWeek = _ref.firstDayOfWeek,\n      firstDayOfWeek = _ref$firstDayOfWeek === void 0 ? 0 : _ref$firstDayOfWeek,\n      header = _ref.header,\n      _ref$locale = _ref.locale,\n      locale = _ref$locale === void 0 ? 'en-US' : _ref$locale,\n      onReference = _ref.onReference,\n      onSelect = _ref.onSelect,\n      range = _ref.range,\n      referenceProp = _ref.reference,\n      _ref$showAdjacentDays = _ref.showAdjacentDays,\n      showAdjacentDays = _ref$showAdjacentDays === void 0 ? true : _ref$showAdjacentDays,\n      _ref$size = _ref.size,\n      size = _ref$size === void 0 ? 'medium' : _ref$size,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"animate\", \"bounds\", \"date\", \"dates\", \"daysOfWeek\", \"disabled\", \"firstDayOfWeek\", \"header\", \"locale\", \"onReference\", \"onSelect\", \"range\", \"reference\", \"showAdjacentDays\", \"size\"]);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme; // set date when caller changes it, allows us to change it internally too\n\n  var _useState = useState(dateProp),\n      date = _useState[0],\n      setDate = _useState[1];\n\n  useEffect(function () {\n    return setDate(dateProp);\n  }, [dateProp]); // set dates when caller changes it, allows us to change it internally too\n\n  var _useState2 = useState(datesProp),\n      dates = _useState2[0],\n      setDates = _useState2[1];\n\n  useEffect(function () {\n    return setDates(datesProp);\n  }, [datesProp]); // set reference based on what the caller passed or date/dates.\n\n  var _useState3 = useState(normalizeReference(referenceProp, date, dates)),\n      reference = _useState3[0],\n      setReference = _useState3[1];\n\n  useEffect(function () {\n    return setReference(normalizeReference(referenceProp, dateProp, datesProp));\n  }, [dateProp, datesProp, referenceProp]); // calculate the bounds we display based on the reference\n\n  var _useState4 = useState(buildDisplayBounds(reference, firstDayOfWeek)),\n      displayBounds = _useState4[0],\n      setDisplayBounds = _useState4[1];\n\n  var _useState5 = useState(),\n      targetDisplayBounds = _useState5[0],\n      setTargetDisplayBounds = _useState5[1];\n\n  var _useState6 = useState(),\n      slide = _useState6[0],\n      setSlide = _useState6[1]; // When the reference changes, we need to update the displayBounds.\n  // This is easy when we aren't animating. If we are animating,\n  // we temporarily increase the displayBounds to be the union of the old\n  // and new ones and set slide to drive the animation. We keep track\n  // of where we are heading via targetDisplayBounds. When the animation\n  // finishes, we prune displayBounds down to where we are headed and\n  // clear the slide and targetDisplayBounds.\n\n\n  useEffect(function () {\n    var nextDisplayBounds = buildDisplayBounds(reference, firstDayOfWeek);\n\n    if (!animate) {\n      setDisplayBounds(nextDisplayBounds);\n    } else {\n      setTargetDisplayBounds(nextDisplayBounds);\n    }\n  }, [animate, firstDayOfWeek, reference]);\n  useEffect(function () {\n    if (targetDisplayBounds) {\n      var animating;\n\n      if (targetDisplayBounds[0].getTime() < displayBounds[0].getTime()) {\n        // only animate if the duration is within a year\n        if (displayBounds[0].getTime() - targetDisplayBounds[0].getTime() < millisecondsPerYear) {\n          setDisplayBounds([targetDisplayBounds[0], displayBounds[1]]);\n          setSlide({\n            direction: 'down',\n            weeks: daysApart(displayBounds[0], targetDisplayBounds[0]) / 7\n          });\n          animating = true;\n        }\n      } else if (targetDisplayBounds[1].getTime() > displayBounds[1].getTime()) {\n        if (targetDisplayBounds[1].getTime() - displayBounds[1].getTime() < millisecondsPerYear) {\n          setDisplayBounds([displayBounds[0], targetDisplayBounds[1]]);\n          setSlide({\n            direction: 'up',\n            weeks: daysApart(targetDisplayBounds[1], displayBounds[1]) / 7\n          });\n          animating = true;\n        }\n      }\n\n      if (animating) {\n        // Wait for animation to finish before cleaning up.\n        var timer = setTimeout(function () {\n          setDisplayBounds(targetDisplayBounds);\n          setTargetDisplayBounds(undefined);\n          setSlide(undefined);\n        }, 400 // Empirically determined.\n        );\n        return function () {\n          return clearTimeout(timer);\n        };\n      }\n\n      return undefined;\n    }\n\n    setSlide(undefined);\n    return undefined;\n  }, [displayBounds, targetDisplayBounds]); // We have to deal with reference being the end of a month with more\n  // days than the month we are changing to. So, we always set reference\n  // to the first of the month before changing the month.\n\n  var previousMonth = useMemo(function () {\n    return endOfMonth(subtractMonths(startOfMonth(reference), 1));\n  }, [reference]);\n  var nextMonth = useMemo(function () {\n    return startOfMonth(addMonths(startOfMonth(reference), 1));\n  }, [reference]);\n  var daysRef = useRef();\n\n  var _useState7 = useState(),\n      focus = _useState7[0],\n      setFocus = _useState7[1];\n\n  var _useState8 = useState(),\n      active = _useState8[0],\n      setActive = _useState8[1]; // when working on a range, remember the last selected date so we know\n  // how to handle subsequent date selection\n\n\n  var _useState9 = useState(),\n      lastSelectedDate = _useState9[0],\n      setLastSelectedDate = _useState9[1];\n\n  var changeReference = useCallback(function (nextReference) {\n    if (betweenDates(nextReference, validBounds)) {\n      setReference(nextReference);\n      if (onReference) onReference(nextReference.toISOString());\n    }\n  }, [onReference, validBounds]);\n  var selectDate = useCallback(function (selectedDate) {\n    var nextDates;\n    var nextDate;\n\n    if (!range) {\n      nextDate = selectedDate;\n    } else if (!dates) {\n      if (!date) {\n        nextDate = selectedDate;\n      } else {\n        var priorDate = new Date(date);\n        var selDate = new Date(selectedDate);\n\n        if (priorDate.getTime() < selDate.getTime()) {\n          nextDates = [[date, selectedDate]];\n          nextDate = undefined;\n        } else if (priorDate.getTime() > selDate.getTime()) {\n          nextDates = [[selectedDate, date]];\n          nextDate = undefined;\n        } else {\n          nextDate = undefined;\n        }\n      }\n    } else {\n      // have dates\n      var priorDates = dates[0].map(function (d) {\n        return new Date(d);\n      });\n      var previousDate = new Date(lastSelectedDate || dates[0][0]);\n\n      var _selDate = new Date(selectedDate);\n\n      if (_selDate.getTime() === priorDates[0].getTime()) {\n        var _dates$ = dates[0];\n        nextDate = _dates$[1];\n        nextDates = undefined;\n      } else if (_selDate.getTime() === priorDates[1].getTime()) {\n        var _dates$2 = dates[0];\n        nextDate = _dates$2[0];\n        nextDates = undefined;\n      } else if (_selDate.getTime() === previousDate.getTime()) {\n        if (_selDate.getTime() < priorDates[0].getTime()) {\n          nextDates = [[selectedDate, dates[0][1]]];\n        } else if (_selDate.getTime() > priorDates[0].getTime()) {\n          nextDates = [[dates[0][0], selectedDate]];\n        }\n      } else if (_selDate.getTime() < previousDate.getTime()) {\n        if (_selDate.getTime() < priorDates[0].getTime()) {\n          nextDates = [[selectedDate, dates[0][1]]];\n        } else if (_selDate.getTime() > priorDates[0].getTime()) {\n          nextDates = [[dates[0][0], selectedDate]];\n        }\n      } else if (_selDate.getTime() > previousDate.getTime()) {\n        if (_selDate.getTime() > priorDates[1].getTime()) {\n          nextDates = [[dates[0][0], selectedDate]];\n        } else if (_selDate.getTime() < priorDates[1].getTime()) {\n          nextDates = [[selectedDate, dates[0][1]]];\n        }\n      }\n    }\n\n    setDates(nextDates);\n    if (!dates) setDate(nextDate);\n    setActive(new Date(selectedDate));\n    setLastSelectedDate(selectedDate);\n    if (onSelect) onSelect(nextDates || nextDate);\n  }, [date, dates, lastSelectedDate, onSelect, range]);\n\n  var renderCalendarHeader = function renderCalendarHeader() {\n    var PreviousIcon = size === 'small' ? theme.calendar.icons.small.previous : theme.calendar.icons.previous;\n    var NextIcon = size === 'small' ? theme.calendar.icons.small.next : theme.calendar.icons.next;\n    return /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      justify: \"between\",\n      align: \"center\"\n    }, /*#__PURE__*/React.createElement(Box, {\n      flex: true,\n      pad: {\n        horizontal: headingPadMap[size] || 'small'\n      }\n    }, /*#__PURE__*/React.createElement(Heading, {\n      level: size === 'small' ? theme.calendar.heading && theme.calendar.heading.level || 4 : (theme.calendar.heading && theme.calendar.heading.level || 4) - 1,\n      size: size,\n      margin: \"none\"\n    }, reference.toLocaleDateString(locale, {\n      month: 'long',\n      year: 'numeric'\n    }))), /*#__PURE__*/React.createElement(Box, {\n      flex: false,\n      direction: \"row\",\n      align: \"center\"\n    }, /*#__PURE__*/React.createElement(Button, {\n      a11yTitle: previousMonth.toLocaleDateString(locale, {\n        month: 'long',\n        year: 'numeric'\n      }),\n      icon: /*#__PURE__*/React.createElement(PreviousIcon, {\n        size: size !== 'small' ? size : undefined\n      }),\n      disabled: !betweenDates(previousMonth, validBounds),\n      onClick: function onClick() {\n        return changeReference(previousMonth);\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      a11yTitle: nextMonth.toLocaleDateString(locale, {\n        month: 'long',\n        year: 'numeric'\n      }),\n      icon: /*#__PURE__*/React.createElement(NextIcon, {\n        size: size !== 'small' ? size : undefined\n      }),\n      disabled: !betweenDates(nextMonth, validBounds),\n      onClick: function onClick() {\n        return changeReference(nextMonth);\n      }\n    })));\n  };\n\n  var renderDaysOfWeek = function renderDaysOfWeek() {\n    var day = new Date(displayBounds[0]);\n    var days = [];\n\n    while (days.length < 7) {\n      days.push( /*#__PURE__*/React.createElement(StyledDayContainer, {\n        key: days.length,\n        sizeProp: size\n      }, /*#__PURE__*/React.createElement(StyledDay, {\n        otherMonth: true,\n        sizeProp: size\n      }, day.toLocaleDateString(locale, {\n        weekday: 'narrow'\n      }))));\n      day = addDays(day, 1);\n    }\n\n    return /*#__PURE__*/React.createElement(StyledWeek, null, days);\n  };\n\n  var weeks = [];\n  var day = new Date(displayBounds[0]);\n  var days;\n  var firstDayInMonth;\n\n  while (day.getTime() < displayBounds[1].getTime()) {\n    if (day.getDay() === firstDayOfWeek) {\n      if (days) {\n        weeks.push( /*#__PURE__*/React.createElement(StyledWeek, {\n          key: day.getTime()\n        }, days));\n      }\n\n      days = [];\n    }\n\n    var otherMonth = day.getMonth() !== reference.getMonth();\n\n    if (!showAdjacentDays && otherMonth) {\n      days.push( /*#__PURE__*/React.createElement(StyledDayContainer, {\n        key: day.getTime(),\n        sizeProp: size\n      }, /*#__PURE__*/React.createElement(StyledDay, {\n        sizeProp: size\n      })));\n    } else {\n      (function () {\n        var dateString = day.toISOString(); // this.dayRefs[dateString] = React.createRef();\n\n        var selected = false;\n        var inRange = false;\n        var selectedState = withinDates(day, date || dates);\n\n        if (selectedState === 2) {\n          selected = true;\n        } else if (selectedState === 1) {\n          inRange = true;\n        }\n\n        var dayDisabled = withinDates(day, disabled) || validBounds && !betweenDates(day, validBounds);\n\n        if (!firstDayInMonth && !dayDisabled && day.getMonth() === reference.getMonth()) {\n          firstDayInMonth = dateString;\n        }\n\n        days.push( /*#__PURE__*/React.createElement(StyledDayContainer, {\n          key: day.getTime(),\n          sizeProp: size\n        }, /*#__PURE__*/React.createElement(Button, {\n          a11yTitle: day.toDateString(),\n          plain: true,\n          tabIndex: -1,\n          active: active && active.getTime() === day.getTime(),\n          disabled: dayDisabled && !!dayDisabled,\n          onClick: function onClick() {\n            selectDate(dateString); // Chrome moves the focus indicator to this button. Set\n            // the focus to the grid of days instead.\n\n            daysRef.current.focus();\n          },\n          onMouseOver: function onMouseOver() {\n            return setActive(new Date(dateString));\n          },\n          onMouseOut: function onMouseOut() {\n            return setActive(undefined);\n          },\n          onFocus: function onFocus() {},\n          onBlur: function onBlur() {}\n        }, /*#__PURE__*/React.createElement(StyledDay, {\n          inRange: inRange,\n          otherMonth: day.getMonth() !== reference.getMonth(),\n          isSelected: selected,\n          sizeProp: size\n        }, day.getDate()))));\n      })();\n    }\n\n    day = addDays(day, 1);\n  }\n\n  weeks.push( /*#__PURE__*/React.createElement(StyledWeek, {\n    key: day.getTime()\n  }, days));\n  return /*#__PURE__*/React.createElement(StyledCalendar, _extends({\n    ref: ref,\n    sizeProp: size\n  }, rest), /*#__PURE__*/React.createElement(Box, null, header ? header({\n    date: reference,\n    locale: locale,\n    onPreviousMonth: function onPreviousMonth() {\n      return changeReference(previousMonth);\n    },\n    onNextMonth: function onNextMonth() {\n      return changeReference(nextMonth);\n    },\n    previousInBound: betweenDates(previousMonth, validBounds),\n    nextInBound: betweenDates(nextMonth, validBounds)\n  }) : renderCalendarHeader(previousMonth, nextMonth), daysOfWeek && renderDaysOfWeek(), /*#__PURE__*/React.createElement(Keyboard, {\n    onEnter: function onEnter() {\n      return selectDate(active.toISOString());\n    },\n    onUp: function onUp(event) {\n      event.preventDefault();\n      event.stopPropagation(); // so the page doesn't scroll\n\n      setActive(addDays(active, -7));\n    },\n    onDown: function onDown(event) {\n      event.preventDefault();\n      event.stopPropagation(); // so the page doesn't scroll\n\n      setActive(addDays(active, 7));\n    },\n    onLeft: function onLeft() {\n      return active && setActive(addDays(active, -1));\n    },\n    onRight: function onRight() {\n      return active && setActive(addDays(active, 1));\n    }\n  }, /*#__PURE__*/React.createElement(StyledWeeksContainer, {\n    ref: daysRef,\n    sizeProp: size,\n    tabIndex: 0,\n    focus: focus,\n    onFocus: function onFocus() {\n      setFocus(true);\n\n      if (date && betweenDates(new Date(date), displayBounds)) {\n        setActive(new Date(date));\n      } else {\n        setActive(new Date(firstDayInMonth));\n      }\n    },\n    onBlur: function onBlur() {\n      setFocus(false);\n      setActive(undefined);\n    }\n  }, /*#__PURE__*/React.createElement(StyledWeeks, {\n    slide: slide,\n    sizeProp: size\n  }, weeks)))));\n});\nCalendar.displayName = 'Calendar';\nvar CalendarDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  // eslint-disable-next-line global-require\n  CalendarDoc = require('./doc').doc(Calendar);\n}\n\nvar CalendarWrapper = CalendarDoc || Calendar;\nexport { CalendarWrapper as Calendar };"]},"metadata":{},"sourceType":"module"}